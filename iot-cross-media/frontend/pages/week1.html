<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>第1週：IoT 基礎與環境建置 - IoT Cross-Media 教學系統</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome Icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <!-- Prism.js for code highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet">
    <!-- 自定義樣式 -->
    <link href="/assets/css/main.css" rel="stylesheet">
    
    <style>
        .learning-section {
            border-left: 4px solid #0d6efd;
            padding-left: 20px;
            margin-bottom: 30px;
        }
        .code-example {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
        }
        .exercise-card {
            border: 2px solid #198754;
            background-color: #d1e7dd;
        }
        .theory-card {
            border: 2px solid #0dcaf0;
            background-color: #cff4fc;
        }
        .progress-tracker {
            position: sticky;
            top: 20px;
        }
        .step-completed {
            color: #198754;
        }
        .step-current {
            color: #fd7e14;
            font-weight: bold;
        }
        .api-result {
            background-color: #000;
            color: #0f0;
            padding: 10px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            min-height: 100px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <!-- 導航欄 -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="/">
                <i class="fas fa-microchip me-2"></i>
                IoT Cross-Media 教學系統
            </a>
            
            <div class="navbar-nav ms-auto">
                <span class="navbar-text">
                    <i class="fas fa-calendar-week me-2"></i>第1週課程
                </span>
            </div>
        </div>
    </nav>

    <div class="container-fluid mt-4">
        <div class="row">
            <!-- 左側內容 -->
            <div class="col-lg-9">
                <!-- 課程標題 -->
                <div class="card mb-4">
                    <div class="card-header bg-primary text-white">
                        <h2 class="mb-0">
                            <i class="fas fa-rocket me-2"></i>
                            第1週：IoT 基礎與環境建置
                        </h2>
                        <p class="mb-0 mt-2">學習時間：2.5小時 | 理論講解：90分鐘 | 實作練習：60分鐘</p>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-8">
                                <p class="lead">歡迎來到 IoT 世界！本週我們將建立 IoT 系統的基礎概念，完成開發環境設置，並實現您的第一個 API 呼叫。</p>
                            </div>
                            <div class="col-md-4 text-center">
                                <div class="progress mb-2">
                                    <div class="progress-bar" id="lesson-progress" role="progressbar" style="width: 0%"></div>
                                </div>
                                <small class="text-muted">課程進度：<span id="progress-text">0%</span></small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 第一部分：理論講解 (30分鐘) -->
                <div class="learning-section">
                    <div class="card theory-card mb-4">
                        <div class="card-header">
                            <h4><i class="fas fa-book me-2"></i>理論講解 (30分鐘)：IoT 四層架構</h4>
                        </div>
                        <div class="card-body">
                            <h5>🏗️ IoT 系統的四層架構</h5>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="card h-100">
                                        <div class="card-body text-center">
                                            <i class="fas fa-cloud fa-3x text-primary mb-3"></i>
                                            <h6>4. 應用層 (Application Layer)</h6>
                                            <p class="small">使用者介面、資料分析、業務邏輯</p>
                                            <div class="badge bg-primary">Web App</div>
                                            <div class="badge bg-primary">Mobile App</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="card h-100">
                                        <div class="card-body text-center">
                                            <i class="fas fa-server fa-3x text-success mb-3"></i>
                                            <h6>3. 資料處理層 (Data Processing)</h6>
                                            <p class="small">資料儲存、分析、機器學習</p>
                                            <div class="badge bg-success">Database</div>
                                            <div class="badge bg-success">Analytics</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row mt-3">
                                <div class="col-md-6">
                                    <div class="card h-100">
                                        <div class="card-body text-center">
                                            <i class="fas fa-network-wired fa-3x text-warning mb-3"></i>
                                            <h6>2. 網路層 (Network Layer)</h6>
                                            <p class="small">資料傳輸、通訊協定</p>
                                            <div class="badge bg-warning">HTTP/HTTPS</div>
                                            <div class="badge bg-warning">MQTT</div>
                                            <div class="badge bg-warning">WebSocket</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="card h-100">
                                        <div class="card-body text-center">
                                            <i class="fas fa-microchip fa-3x text-danger mb-3"></i>
                                            <h6>1. 感知層 (Perception Layer)</h6>
                                            <p class="small">感測器、致動器、設備</p>
                                            <div class="badge bg-danger">溫度感測器</div>
                                            <div class="badge bg-danger">濕度感測器</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mt-4 p-3 bg-light rounded">
                                <h6><i class="fas fa-lightbulb text-warning me-2"></i>重要概念</h6>
                                <ul>
                                    <li><strong>感測器</strong>：收集環境資料的設備（溫度、濕度、光線等）</li>
                                    <li><strong>API</strong>：應用程式介面，讓不同系統間可以互相溝通</li>
                                    <li><strong>即時資料</strong>：感測器持續產生的最新資料</li>
                                    <li><strong>前後端分離</strong>：前端負責顯示，後端負責資料處理</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 第二部分：環境建置 (30分鐘) -->
                <div class="learning-section">
                    <div class="card mb-4">
                        <div class="card-header bg-info text-white">
                            <h4><i class="fas fa-cogs me-2"></i>環境建置 (30分鐘)：系統安裝和啟動</h4>
                        </div>
                        <div class="card-body">
                            <h5>🛠️ 系統需求檢查</h5>
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <div class="card">
                                        <div class="card-body">
                                            <h6><i class="fas fa-check-circle text-success me-2"></i>必要軟體</h6>
                                            <ul>
                                                <li>Node.js 16.0+ <span class="badge bg-success" id="node-version">檢查中...</span></li>
                                                <li>記憶體 2GB+ <span class="badge bg-success">充足</span></li>
                                                <li>硬碟 500MB+ <span class="badge bg-success">充足</span></li>
                                                <li>現代瀏覽器 <span class="badge bg-success">Chrome/Firefox/Edge</span></li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="card">
                                        <div class="card-body">
                                            <h6><i class="fas fa-terminal text-primary me-2"></i>快速安裝</h6>
                                            <div class="code-example">
                                                <pre><code class="language-bash"># 進入教學版目錄
cd infrastructure/educational

# 一鍵安裝
npm run setup-education

# 一鍵啟動
npm run start-education</code></pre>
                                            </div>
                                            <button class="btn btn-primary btn-sm" onclick="checkNodeVersion()">
                                                <i class="fas fa-check me-1"></i>檢查 Node.js 版本
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 第三部分：開發者工具 (30分鐘) -->
                <div class="learning-section">
                    <div class="card mb-4">
                        <div class="card-header bg-warning text-dark">
                            <h4><i class="fas fa-tools me-2"></i>開發者工具使用 (30分鐘)</h4>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <h5>🔍 瀏覽器開發者工具</h5>
                                    <div class="card">
                                        <div class="card-body">
                                            <ol>
                                                <li>按 <kbd>F12</kbd> 開啟開發者工具</li>
                                                <li>切換到 <strong>Console</strong> 標籤</li>
                                                <li>嘗試執行 JavaScript 指令</li>
                                                <li>觀察 <strong>Network</strong> 標籤的 API 請求</li>
                                            </ol>
                                            <button class="btn btn-warning btn-sm" onclick="openDevTools()">
                                                <i class="fas fa-external-link-alt me-1"></i>體驗開發者工具
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <h5>📊 即時 JavaScript 測試</h5>
                                    <div class="card">
                                        <div class="card-body">
                                            <textarea class="form-control mb-2" id="js-input" rows="3" placeholder="輸入 JavaScript 程式碼...">console.log('Hello IoT World!');</textarea>
                                            <button class="btn btn-success btn-sm" onclick="executeJS()">
                                                <i class="fas fa-play me-1"></i>執行程式碼
                                            </button>
                                            <div id="js-output" class="api-result mt-2"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 第四部分：實作練習 (60分鐘) -->
                <div class="learning-section">
                    <div class="card exercise-card mb-4">
                        <div class="card-header">
                            <h4><i class="fas fa-laptop-code me-2"></i>實作練習 (60分鐘)：第一個 API 呼叫</h4>
                        </div>
                        <div class="card-body">
                            <!-- 練習 1：系統狀態檢查 -->
                            <div class="mb-4">
                                <h5>🎯 練習 1：系統狀態檢查 (15分鐘)</h5>
                                <p>讓我們檢查教學系統是否正常運行。</p>
                                
                                <div class="code-example">
                                    <h6>範例程式碼：</h6>
                                    <pre><code class="language-javascript">// 檢查後端 API 狀態
fetch('http://localhost:3001/api/health')
  .then(response => response.json())
  .then(data => {
    console.log('系統狀態:', data);
    document.getElementById('health-result').innerHTML = 
      `&lt;strong&gt;系統狀態：&lt;/strong&gt; ${data.status}&lt;br&gt;
       &lt;strong&gt;資料庫：&lt;/strong&gt; ${data.database ? '正常' : '異常'}&lt;br&gt;
       &lt;strong&gt;時間：&lt;/strong&gt; ${new Date(data.timestamp).toLocaleString()}`;
  })
  .catch(error => {
    console.error('API 呼叫失敗:', error);
    document.getElementById('health-result').innerHTML = 
      '&lt;span class="text-danger"&gt;無法連接到後端服務&lt;/span&gt;';
  });</code></pre>
                                </div>
                                
                                <button class="btn btn-success" onclick="checkHealth()">
                                    <i class="fas fa-heartbeat me-1"></i>執行健康檢查
                                </button>
                                <div id="health-result" class="api-result mt-2"></div>
                            </div>

                            <!-- 練習 2：設備列表獲取 -->
                            <div class="mb-4">
                                <h5>🎯 練習 2：獲取 IoT 設備列表 (20分鐘)</h5>
                                <p>學習如何從後端 API 獲取設備資料。</p>
                                
                                <div class="code-example">
                                    <h6>範例程式碼：</h6>
                                    <pre><code class="language-javascript">// 獲取所有 IoT 設備
async function getDevices() {
  try {
    const response = await fetch('http://localhost:3001/api/devices');
    const devices = await response.json();
    
    console.log('設備列表:', devices);
    
    // 顯示設備資訊
    let html = '&lt;h6&gt;發現的設備：&lt;/h6&gt;&lt;ul&gt;';
    devices.forEach(device => {
      html += `&lt;li&gt;&lt;strong&gt;${device.name}&lt;/strong&gt; (${device.type}) - ${device.status}&lt;/li&gt;`;
    });
    html += '&lt;/ul&gt;';
    
    document.getElementById('devices-result').innerHTML = html;
    
    // 更新設備計數
    document.getElementById('device-count').textContent = devices.length;
    
  } catch (error) {
    console.error('獲取設備失敗:', error);
    document.getElementById('devices-result').innerHTML = 
      '&lt;span class="text-danger"&gt;無法獲取設備列表&lt;/span&gt;';
  }
}</code></pre>
                                </div>
                                
                                <button class="btn btn-success" onclick="getDevices()">
                                    <i class="fas fa-wifi me-1"></i>獲取設備列表
                                </button>
                                <div class="mt-2">
                                    <span class="badge bg-info">設備總數：<span id="device-count">0</span></span>
                                </div>
                                <div id="devices-result" class="api-result mt-2"></div>
                            </div>

                            <!-- 練習 3：虛擬感測器資料 -->
                            <div class="mb-4">
                                <h5>🎯 練習 3：虛擬感測器資料 (25分鐘)</h5>
                                <p>建立虛擬感測器並模擬即時資料產生。</p>
                                
                                <div class="code-example">
                                    <h6>範例程式碼：</h6>
                                    <pre><code class="language-javascript">// 虛擬感測器類別
class VirtualSensor {
  constructor(id, type, name) {
    this.id = id;
    this.type = type;
    this.name = name;
    this.isActive = false;
  }
  
  // 產生模擬資料
  generateData() {
    const baseValue = this.type === 'temperature' ? 25 : 50;
    const variation = this.type === 'temperature' ? 10 : 30;
    return {
      sensorId: this.id,
      type: this.type,
      value: (baseValue + Math.random() * variation).toFixed(2),
      unit: this.type === 'temperature' ? '°C' : '%',
      timestamp: new Date().toISOString()
    };
  }
  
  // 開始產生資料
  start() {
    this.isActive = true;
    this.interval = setInterval(() => {
      const data = this.generateData();
      this.onDataGenerated(data);
    }, 2000);
  }
  
  // 停止產生資料
  stop() {
    this.isActive = false;
    if (this.interval) clearInterval(this.interval);
  }
  
  // 資料產生回調
  onDataGenerated(data) {
    console.log('感測器資料:', data);
    this.displayData(data);
  }
  
  // 顯示資料
  displayData(data) {
    const resultDiv = document.getElementById('sensor-result');
    const dataLine = `[${new Date(data.timestamp).toLocaleTimeString()}] ${data.type}: ${data.value}${data.unit}`;
    resultDiv.innerHTML = dataLine + '&lt;br&gt;' + resultDiv.innerHTML;
    
    // 限制顯示行數
    const lines = resultDiv.innerHTML.split('&lt;br&gt;');
    if (lines.length > 10) {
      resultDiv.innerHTML = lines.slice(0, 10).join('&lt;br&gt;');
    }
  }
}</code></pre>
                                </div>
                                
                                <div class="row">
                                    <div class="col-md-6">
                                        <button class="btn btn-success" onclick="startVirtualSensor('temperature')">
                                            <i class="fas fa-thermometer-half me-1"></i>啟動溫度感測器
                                        </button>
                                        <button class="btn btn-info ms-2" onclick="startVirtualSensor('humidity')">
                                            <i class="fas fa-tint me-1"></i>啟動濕度感測器
                                        </button>
                                    </div>
                                    <div class="col-md-6">
                                        <button class="btn btn-warning" onclick="stopAllSensors()">
                                            <i class="fas fa-stop me-1"></i>停止所有感測器
                                        </button>
                                    </div>
                                </div>
                                <div id="sensor-result" class="api-result mt-2"></div>
                            </div>

                            <!-- 完成檢查 -->
                            <div class="card border-success">
                                <div class="card-header bg-success text-white">
                                    <h6><i class="fas fa-trophy me-2"></i>第1週學習成果檢查</h6>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <h6>學習目標檢核：</h6>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="check1">
                                                <label class="form-check-label" for="check1">
                                                    理解 IoT 四層架構
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="check2">
                                                <label class="form-check-label" for="check2">
                                                    完成開發環境建置
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="check3">
                                                <label class="form-check-label" for="check3">
                                                    成功執行第一個 API 呼叫
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="check4">
                                                <label class="form-check-label" for="check4">
                                                    熟練操作虛擬設備
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <h6>下週預習：</h6>
                                            <ul class="small">
                                                <li>jQuery 選擇器基礎</li>
                                                <li>AJAX 資料獲取</li>
                                                <li>Bootstrap 組件使用</li>
                                                <li>即時資料圖表</li>
                                            </ul>
                                            <button class="btn btn-primary btn-sm" onclick="saveProgress()">
                                                <i class="fas fa-save me-1"></i>儲存學習進度
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 右側進度追蹤 -->
            <div class="col-lg-3">
                <div class="progress-tracker">
                    <div class="card">
                        <div class="card-header">
                            <h6><i class="fas fa-list-check me-2"></i>學習進度</h6>
                        </div>
                        <div class="card-body">
                            <div class="d-flex align-items-center mb-2">
                                <i class="fas fa-circle step-completed me-2"></i>
                                <small>理論講解 (30分)</small>
                            </div>
                            <div class="d-flex align-items-center mb-2">
                                <i class="fas fa-circle step-completed me-2"></i>
                                <small>環境建置 (30分)</small>
                            </div>
                            <div class="d-flex align-items-center mb-2">
                                <i class="fas fa-circle step-completed me-2"></i>
                                <small>工具使用 (30分)</small>
                            </div>
                            <div class="d-flex align-items-center mb-2">
                                <i class="fas fa-circle step-current me-2"></i>
                                <small>實作練習 (60分)</small>
                            </div>
                            
                            <hr>
                            
                            <h6>🎯 本週目標</h6>
                            <ul class="small">
                                <li>IoT 架構理解</li>
                                <li>環境安裝完成</li>
                                <li>API 呼叫成功</li>
                                <li>虛擬設備操作</li>
                            </ul>
                            
                            <hr>
                            
                            <h6>📚 學習資源</h6>
                            <div class="d-flex flex-column gap-2">
                                <a href="../快速開始.md" class="btn btn-outline-primary btn-sm">
                                    <i class="fas fa-book me-1"></i>快速開始指南
                                </a>
                                <a href="http://localhost:3001/api-docs" target="_blank" class="btn btn-outline-info btn-sm">
                                    <i class="fas fa-code me-1"></i>API 文檔
                                </a>
                                <a href="/pages/week2.html" class="btn btn-outline-success btn-sm">
                                    <i class="fas fa-arrow-right me-1"></i>第2週課程
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Prism.js for code highlighting -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>

    <script>
        // 全域變數
        let virtualSensors = {};
        let lessonProgress = 0;
        
        // 頁面載入完成
        $(document).ready(function() {
            console.log('🎓 第1週課程已載入');
            updateProgress(25); // 初始進度
            checkNodeVersion();
        });

        // 更新課程進度
        function updateProgress(percentage) {
            lessonProgress = percentage;
            $('#lesson-progress').css('width', percentage + '%');
            $('#progress-text').text(percentage + '%');
        }

        // 檢查 Node.js 版本
        function checkNodeVersion() {
            // 模擬檢查（實際需要後端 API）
            setTimeout(() => {
                $('#node-version').text('v18.17.0 ✓');
                updateProgress(30);
            }, 1000);
        }

        // 開啟開發者工具提示
        function openDevTools() {
            alert('請按 F12 鍵開啟瀏覽器開發者工具！\n\n建議步驟：\n1. 按 F12\n2. 點擊 Console 標籤\n3. 在下方輸入框嘗試執行 JavaScript');
            updateProgress(50);
        }

        // 執行 JavaScript 程式碼
        function executeJS() {
            const code = $('#js-input').val();
            const output = $('#js-output');
            
            try {
                // 重新定義 console.log 來捕獲輸出
                const originalLog = console.log;
                const logs = [];
                console.log = function(...args) {
                    logs.push(args.join(' '));
                    originalLog.apply(console, args);
                };
                
                // 執行程式碼
                const result = eval(code);
                
                // 恢復原始的 console.log
                console.log = originalLog;
                
                // 顯示結果
                let outputText = '';
                if (logs.length > 0) {
                    outputText += '> ' + logs.join('\n> ') + '\n';
                }
                if (result !== undefined) {
                    outputText += '回傳值: ' + JSON.stringify(result);
                }
                
                output.text(outputText || '程式碼執行完成（無輸出）');
                
            } catch (error) {
                output.text('錯誤: ' + error.message);
            }
            
            updateProgress(60);
        }

        // 健康檢查
        async function checkHealth() {
            const resultDiv = $('#health-result');
            resultDiv.html('<i class="fas fa-spinner fa-spin"></i> 檢查中...');
            
            try {
                // 模擬 API 呼叫（實際應該連接到真實後端）
                await new Promise(resolve => setTimeout(resolve, 1500));
                
                const mockData = {
                    status: 'healthy',
                    database: true,
                    timestamp: new Date().toISOString(),
                    version: '1.0.0'
                };
                
                resultDiv.html(`
                    <strong>系統狀態：</strong> ${mockData.status}<br>
                    <strong>資料庫：</strong> ${mockData.database ? '正常' : '異常'}<br>
                    <strong>版本：</strong> ${mockData.version}<br>
                    <strong>時間：</strong> ${new Date(mockData.timestamp).toLocaleString()}
                `);
                
                updateProgress(70);
                
            } catch (error) {
                resultDiv.html('<span class="text-danger">無法連接到後端服務</span>');
            }
        }

        // 獲取設備列表
        async function getDevices() {
            const resultDiv = $('#devices-result');
            resultDiv.html('<i class="fas fa-spinner fa-spin"></i> 載入設備中...');
            
            try {
                // 模擬 API 呼叫
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                const mockDevices = [
                    { id: 1, name: '溫度感測器-01', type: 'temperature', status: 'online' },
                    { id: 2, name: '濕度感測器-01', type: 'humidity', status: 'online' },
                    { id: 3, name: '光線感測器-01', type: 'light', status: 'offline' },
                    { id: 4, name: 'LED 控制器-01', type: 'actuator', status: 'online' }
                ];
                
                let html = '<h6>發現的設備：</h6><ul>';
                mockDevices.forEach(device => {
                    const statusClass = device.status === 'online' ? 'text-success' : 'text-danger';
                    html += `<li><strong>${device.name}</strong> (${device.type}) - <span class="${statusClass}">${device.status}</span></li>`;
                });
                html += '</ul>';
                
                resultDiv.html(html);
                $('#device-count').text(mockDevices.length);
                
                updateProgress(80);
                
            } catch (error) {
                resultDiv.html('<span class="text-danger">無法獲取設備列表</span>');
            }
        }

        // 虛擬感測器類別
        class VirtualSensor {
            constructor(id, type, name) {
                this.id = id;
                this.type = type;
                this.name = name;
                this.isActive = false;
            }
            
            generateData() {
                const baseValue = this.type === 'temperature' ? 25 : 50;
                const variation = this.type === 'temperature' ? 10 : 30;
                return {
                    sensorId: this.id,
                    type: this.type,
                    value: (baseValue + Math.random() * variation).toFixed(2),
                    unit: this.type === 'temperature' ? '°C' : '%',
                    timestamp: new Date().toISOString()
                };
            }
            
            start() {
                this.isActive = true;
                this.interval = setInterval(() => {
                    const data = this.generateData();
                    this.displayData(data);
                }, 2000);
            }
            
            stop() {
                this.isActive = false;
                if (this.interval) clearInterval(this.interval);
            }
            
            displayData(data) {
                const resultDiv = document.getElementById('sensor-result');
                const dataLine = `[${new Date(data.timestamp).toLocaleTimeString()}] ${data.type}: ${data.value}${data.unit}`;
                resultDiv.innerHTML = dataLine + '<br>' + resultDiv.innerHTML;
                
                // 限制顯示行數
                const lines = resultDiv.innerHTML.split('<br>');
                if (lines.length > 10) {
                    resultDiv.innerHTML = lines.slice(0, 10).join('<br>');
                }
            }
        }

        // 啟動虛擬感測器
        function startVirtualSensor(type) {
            const id = type + '-' + Date.now();
            const name = type === 'temperature' ? '溫度感測器' : '濕度感測器';
            
            if (virtualSensors[type]) {
                virtualSensors[type].stop();
            }
            
            virtualSensors[type] = new VirtualSensor(id, type, name);
            virtualSensors[type].start();
            
            $('#sensor-result').prepend(`<strong>[${new Date().toLocaleTimeString()}] ${name} 已啟動</strong><br>`);
            updateProgress(90);
        }

        // 停止所有感測器
        function stopAllSensors() {
            Object.values(virtualSensors).forEach(sensor => sensor.stop());
            virtualSensors = {};
            $('#sensor-result').prepend(`<strong>[${new Date().toLocaleTimeString()}] 所有感測器已停止</strong><br>`);
        }

        // 儲存學習進度
        function saveProgress() {
            const checkedItems = $('.form-check-input:checked').length;
            const totalItems = $('.form-check-input').length;
            const completionRate = Math.round((checkedItems / totalItems) * 100);
            
            updateProgress(100);
            
            alert(`第1週學習進度已儲存！\n完成率：${completionRate}%\n\n${checkedItems}/${totalItems} 個目標已達成`);
            
            // 模擬儲存到本地儲存
            localStorage.setItem('week1_progress', JSON.stringify({
                completion: completionRate,
                timestamp: new Date().toISOString(),
                checkedItems: checkedItems
            }));
        }
    </script>
</body>
</html>
